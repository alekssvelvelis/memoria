{"ast":null,"code":"import React,{useState}from'react';import PasswordToggle from'../PasswordToggle';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function ProfileChangePassword(_ref){let{onClose,hasPassword,onPasswordChange}=_ref;const[errors,setErrors]=useState({});const[success,setSuccess]=useState([]);const handleSubmitForm=async e=>{e.preventDefault();const formData={password:e.target.password?e.target.password.value.trim():'',confirmPassword:e.target.confirmPassword?e.target.confirmPassword.value.trim():'',currentPassword:e.target.currentPassword?e.target.currentPassword.value.trim():''};const validationErrors={};const passwordToClear=formData.password;const confirmToClear=formData.confirmPassword;const currentPassword=formData.currentPassword;if(!passwordToClear){validationErrors.password='Password is required';}else if(passwordToClear.length<8){validationErrors.password='Minimum length is 8 symbols';}if(!confirmToClear){validationErrors.confirmPassword='Confirmed password is required';}else if(confirmToClear.length<8){validationErrors.confirmPassword='Minimum length is 8 symbols';}else if(confirmToClear!==passwordToClear){validationErrors.confirmPassword='Passwords do not match';}if(hasPassword){if(!currentPassword){validationErrors.currentPassword='Current password is required';}}setSuccess('');if(Object.keys(validationErrors).length===0){try{const isLoggedInObject=localStorage.getItem('token');const isLoggedIn=isLoggedInObject?JSON.parse(isLoggedInObject).value:null;const response=await fetch('http://localhost/api/updatePassword',{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(isLoggedIn)},body:JSON.stringify(formData)});const responseData=await response.json();if(!response.ok){console.error('Error:',responseData.error);setSuccess('');if(responseData.error==='Invalid current password'){setErrors({currentPassword:'Wrong current password'});}throw new Error('Password update failed');}setErrors({});setSuccess('Password updated!');if(errors.length===0){setTimeout(()=>{onClose();onPasswordChange();},7000);}}catch(error){console.error('Error:',error.message);}}else{setErrors(validationErrors);}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{onClick:onClose,className:\"w-screen h-screen fixed top-0 left-0 bg-black bg-opacity-40 z-40 transition-opacity duration-300 opacity-100\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-[3px] z-[45] text-white border-neutral-300 bg-[#181a1b] shadow-lg sm:ml-0 md:ml-0 lg:ml-0 lg:ml-0 min-h-[300px] xl:w-[500px] lg:w-[500px] md:w-[500px] sm:w-[500px] max-[425px]:w-[400px] max-[375px]:w-[350px] max-[325px]:w-[310px]  w-[400px] font-light rounded-md shadow-lg mb-4 max-[769px]:mt-[24px] mt-[48px] fixed -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"absolute right-2 text-3xl text-white cursor-pointer hover:text-gray-300\",children:\"X\"}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full min-h-full flex flex-wrap\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"w-full min-h-full flex flex-col justify-center items-center\",onSubmit:handleSubmitForm,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-[95%]\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl tracking-widest my-1\",children:\"Change your password:\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-light text-lg uppercase text-[rgb(175,169,158)] mb-4 mt-2\",children:\"Enter your new password\"})]}),!hasPassword?'':/*#__PURE__*/_jsxs(\"div\",{className:\"w-[90%]\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"ml-3 text-lg uppercase tracking-widest\",htmlFor:\"currentPassword\",children:\"Current password:\"}),/*#__PURE__*/_jsx(PasswordToggle,{id:\"currentPassword\"}),errors.currentPassword&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 ml-3 my-2 text-lg\",children:errors.currentPassword})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-[90%]\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"ml-3 text-lg uppercase tracking-widest\",htmlFor:\"password\",children:\"Password:\"}),/*#__PURE__*/_jsx(PasswordToggle,{id:\"password\"}),errors.password&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 ml-3 my-2 text-lg\",children:errors.password})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-[90%]\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"ml-3 text-lg uppercase tracking-widest\",htmlFor:\"confirmPassword\",children:\"Confirm Password:\"}),/*#__PURE__*/_jsx(PasswordToggle,{id:\"confirmPassword\"}),errors.confirmPassword&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 ml-3 my-2 text-lg\",children:errors.confirmPassword})]}),/*#__PURE__*/_jsx(\"input\",{className:\"mt-4 w-[75%] my-2 h-10 bg-[rgb(33,36,37)] hover:bg-[rgb(39,42,43)] hover:border-neutral-200 focus:border-2 border-neutral-600 border text-white text-2xl rounded-sm duration-500 hover:scale-105 cursor-pointer\",type:\"submit\",value:\"Change\"}),success&&/*#__PURE__*/_jsx(\"p\",{className:\"text-green-500 my-2 text-xl\",children:success})]})})]})]});}export default ProfileChangePassword;","map":{"version":3,"names":["React","useState","PasswordToggle","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ProfileChangePassword","_ref","onClose","hasPassword","onPasswordChange","errors","setErrors","success","setSuccess","handleSubmitForm","e","preventDefault","formData","password","target","value","trim","confirmPassword","currentPassword","validationErrors","passwordToClear","confirmToClear","length","Object","keys","isLoggedInObject","localStorage","getItem","isLoggedIn","JSON","parse","response","fetch","method","headers","concat","body","stringify","responseData","json","ok","console","error","Error","setTimeout","message","children","onClick","className","onSubmit","htmlFor","id","type"],"sources":["/Users/alekssvelvelis/Desktop/memory-game/src/components/Profile/ProfileChangePassword.jsx"],"sourcesContent":["import React, { useState } from 'react';\nimport PasswordToggle from '../PasswordToggle';\n\nfunction ProfileChangePassword({ onClose, hasPassword, onPasswordChange }) {\n    const [errors, setErrors] = useState({});\n    const [success, setSuccess] = useState([]);\n    const handleSubmitForm = async (e) => {\n        e.preventDefault();\n    \n        const formData = {\n            password: e.target.password ? e.target.password.value.trim() : '',\n            confirmPassword: e.target.confirmPassword ? e.target.confirmPassword.value.trim() : '',\n            currentPassword: e.target.currentPassword ? e.target.currentPassword.value.trim() : '',\n        };\n\n        const validationErrors = {};\n        const passwordToClear = formData.password;\n        const confirmToClear = formData.confirmPassword;\n        const currentPassword = formData.currentPassword;\n        \n        if(!passwordToClear){\n            validationErrors.password = 'Password is required';\n        }else if (passwordToClear.length < 8){\n            validationErrors.password = 'Minimum length is 8 symbols';\n        }\n\n        if(!confirmToClear){\n            validationErrors.confirmPassword = 'Confirmed password is required';\n        }else if (confirmToClear.length < 8){\n            validationErrors.confirmPassword = 'Minimum length is 8 symbols';\n        }  else if (confirmToClear !== passwordToClear) {\n            validationErrors.confirmPassword = 'Passwords do not match';\n        }\n\n        if(hasPassword){\n            if(!currentPassword){\n                validationErrors.currentPassword = 'Current password is required';\n            }\n        }\n        setSuccess('');\n        if (Object.keys(validationErrors).length === 0) {\n            try {\n                const isLoggedInObject = localStorage.getItem('token');\n                const isLoggedIn = isLoggedInObject ? JSON.parse(isLoggedInObject).value : null;\n                const response = await fetch('http://localhost/api/updatePassword', {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        'Authorization': `Bearer ${isLoggedIn}`\n                    },\n                    body: JSON.stringify(formData)\n                });\n                const responseData = await response.json();\n                if (!response.ok) {\n                    console.error('Error:', responseData.error);\n                    setSuccess('');\n                    if (responseData.error === 'Invalid current password') {\n                        setErrors({ currentPassword: 'Wrong current password' });\n                    }\n                    throw new Error('Password update failed');\n                }\n                setErrors({});\n                setSuccess('Password updated!');\n                if(errors.length === 0){\n                    setTimeout(() => {\n                        onClose();\n                        onPasswordChange();\n                    }, 7000);\n                }\n\n            } catch (error) {\n                console.error('Error:', error.message);\n            }\n        } else {\n            setErrors(validationErrors);\n        }\n    };\n    return(\n        <>\n        <div onClick={onClose} className={`w-screen h-screen fixed top-0 left-0 bg-black bg-opacity-40 z-40 transition-opacity duration-300 opacity-100`}></div>\n        <div className={`border-[3px] z-[45] text-white border-neutral-300 bg-[#181a1b] shadow-lg sm:ml-0 md:ml-0 lg:ml-0 lg:ml-0 min-h-[300px] xl:w-[500px] lg:w-[500px] md:w-[500px] sm:w-[500px] max-[425px]:w-[400px] max-[375px]:w-[350px] max-[325px]:w-[310px]  w-[400px] font-light rounded-md shadow-lg mb-4 max-[769px]:mt-[24px] mt-[48px] fixed -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2`}>\n            <button\n                onClick={onClose}\n                className='absolute right-2 text-3xl text-white cursor-pointer hover:text-gray-300'\n            >\n                X\n            </button>\n            <div className='w-full min-h-full flex flex-wrap'>\n                    <form className='w-full min-h-full flex flex-col justify-center items-center' onSubmit={(handleSubmitForm)}>\n                        <div className='w-[95%]'>\n                            <h1 className='text-2xl tracking-widest my-1'>Change your password:</h1>\n                            <p className='font-light text-lg uppercase text-[rgb(175,169,158)] mb-4 mt-2'>Enter your new password</p>\n                        </div>\n                        {!hasPassword ? '' :\n                            <div className='w-[90%]'>\n                            <label className='ml-3 text-lg uppercase tracking-widest' htmlFor='currentPassword'>Current password:</label>\n                            <PasswordToggle id='currentPassword'/>\n                            {errors.currentPassword && <p className=\"text-red-500 ml-3 my-2 text-lg\">{errors.currentPassword}</p>}\n                        </div>\n                        }\n                        <div className='w-[90%]'>\n                            <label className='ml-3 text-lg uppercase tracking-widest' htmlFor='password'>Password:</label>\n                            <PasswordToggle id='password'/>\n                            {errors.password && <p className=\"text-red-500 ml-3 my-2 text-lg\">{errors.password}</p>}\n                        </div>\n                        <div className='w-[90%]'>\n                        <label className='ml-3 text-lg uppercase tracking-widest' htmlFor='confirmPassword'>Confirm Password:</label>\n                            <PasswordToggle id='confirmPassword'/>\n                            {errors.confirmPassword && <p className=\"text-red-500 ml-3 my-2 text-lg\">{errors.confirmPassword}</p>}\n                        </div>\n                        <input className='mt-4 w-[75%] my-2 h-10 bg-[rgb(33,36,37)] hover:bg-[rgb(39,42,43)] hover:border-neutral-200 focus:border-2 border-neutral-600 border text-white text-2xl rounded-sm duration-500 hover:scale-105 cursor-pointer' type='submit' value='Change' />\n                        {success && <p className='text-green-500 my-2 text-xl'>{success}</p>}\n                    </form>\n            </div>\n        </div>\n        </>\n    );\n}\n\nexport default ProfileChangePassword;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}